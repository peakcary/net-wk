<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../favicon.ico">
    <title>悟空管理</title>
    <!-- Bootstrap core CSS -->
    <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="css/common.css" rel="stylesheet" type="text/css" />
    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script type="text/javascript" src="../src/html5shiv.min.js"></script>
    <script type="text/javascript" src="../src/respond.min.js"></script> 
    <![endif]-->
    <link href="lib/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="lib/jqcool.net-summernote/dist/summernote.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header"> 
          <a class="navbar-brand" href="#">WK</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right"> 
            <li><a href="#">Help</a></li>
          </ul> 
        </div>
      </div>
    </nav>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-3 col-md-2 sidebar">
                <ul class="nav nav-sidebar" id="leftNav">
                </ul>
            </div>
            <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
                <div class="form-horizontal">
                    <div class="form-group">
                        <label for="market_id" class="col-sm-2 control-label">
                            菜品所在商户</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" value="0" id="market_id" placeholder="菜品所在商户" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="dish_type" class="col-sm-2 control-label">
                            菜品类别</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="dish_type" placeholder="菜品类别" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="name_en" class="col-sm-2 control-label">
                            英文菜品名称</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="name_en" placeholder="英文菜品名称" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="name_cn" class="col-sm-2 control-label">
                            中文菜品名称</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="name_cn" placeholder="中文菜品名称" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="original_price" class="col-sm-2 control-label">
                            菜品原价</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="original_price" placeholder="菜品原价" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="discount_price" class="col-sm-2 control-label">
                            菜品折扣价</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="discount_price" placeholder="菜品折扣价" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="sort" class="col-sm-2 control-label">
                            排序</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="sort" placeholder="排序" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="remark" class="col-sm-2 control-label">
                            备注</label>
                        <div class="col-sm-10">
                            <div id="remark">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="remark" class="col-sm-2 control-label">
                            图片</label>
                        <div class="col-sm-10">
                            <div id="container">
                                <a class="btn btn-default " id="pickfiles" href="#"><i class="glyphicon glyphicon-plus">
                                </i><span>选择文件</span> </a>
                            </div>
                            <div id="fileInfo">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10">
                            <button type="submit" class="btn btn-primary" onclick="editData()">
                                保存</button>
                            <button type="submit" class="btn btn-info" onclick="goPageList()">
                                取消</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <input type="hidden" id="hid" />
    <script src="lib/jqurey/1.12.4/jquery.min.js" type="text/javascript"></script>
    <script src="lib/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="lib/jquery-tmpl/jquery.tmpl.min.js" type="text/javascript"></script>
    <script src="js/common.js" type="text/javascript"></script>
    <script id="leftNavTemplate" type="text/x-jquery-tmpl">
         <li><a href="${url}">${name}</a></li> 
    </script>
    
    <script src="lib/plupload-2.1.9/js/plupload.full.min.js" type="text/javascript"></script>
    <script src="lib/qiniu/dist/qiniu.min.js" type="text/javascript"></script>
    <script src="lib/jqcool.net-summernote/dist/summernote.min.js" type="text/javascript"></script>
    <script src="js/bus_dish_edit.js" type="text/javascript"></script>
    <script type="text/javascript">
        var urlUpload = "../Handler/Upload.ashx";
        $(function () {
            //编辑器
            $('#remark').summernote({ height: 150 }); 
     
            var uploader = Qiniu.uploader({
                runtimes: 'html5,flash,html4',
                browse_button: 'pickfiles',
                container: 'container',
                drop_element: 'container',
                max_file_size: '1000mb',
                flash_swf_url: '../../../plupload-2.1.9/js/Moxie.swf',
                dragdrop: true,
                chunk_size: '4mb',
                multi_selection: !(mOxie.Env.OS.toLowerCase() === "ios"),
                uptoken_func: function () {
                    var ajax = new XMLHttpRequest();
                    ajax.open('GET', urlUpload, false);
                    ajax.setRequestHeader("If-Modified-Since", "0");
                    ajax.send();
                    if (ajax.status === 200) {
                        return ajax.responseText;
                    } else {
                        console.log('custom uptoken_func err');
                        return '';
                    }
                },
                domain: "om2v517pk.bkt.clouddn.com",
                get_new_uptoken: false,
                auto_start: true,
                log_level: 5,
                init: {
                    'FilesAdded': function (up, files) {
                        $('#success').hide();
                        console.log("----------FilesAdded", up, file);

                    },
                    'BeforeUpload': function (up, file) {
                        console.log("----------BeforeUpload", up, file);

                    },
                    'UploadProgress': function (up, file) {
                        console.log("----------UploadProgress", up, file);

                    },
                    'UploadComplete': function () {
                        $('#success').show();
                    },
                    'FileUploaded': function (up, file, info) {
                        console.log("----------FileUploaded1", JSON.stringify(up));
                        console.log("----------FileUploaded2", JSON.stringify(file));
                        console.log("----------FileUploaded3", JSON.stringify(info));
                        var res = $.parseJSON(info);
                        var imageUrl = "http://om2v517pk.bkt.clouddn.com/" + res.key;
                        //$("#fileInfo").html("http://om2v517pk.bkt.clouddn.com/" + res.key);
                        var image = $("<image ref='" + res.key + "' width='70' height='70' src='" + imageUrl + "'/>");
                        $("#fileInfo").append(image);

                    },
                    'Error': function (up, err, errTip) {
                        console.log("----------UploadProgress", up, err, errTip);

                    }
                }
            });
            uploader.bind('FileUploaded', function () {
                console.log('hello man,a file is uploaded');
            });
        }); 
    </script>
</body>
</html>
