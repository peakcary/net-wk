<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">
    <title>悟空送餐</title>
    <!-- Bootstrap core CSS -->
    <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <!-- Bootstrap theme -->
    <link href="lib/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css" />
    <link href="lib/jquery-pagination/lib/pagination.css" rel="stylesheet" type="text/css" />
    <link href="css/common.css" rel="stylesheet" type="text/css" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script type="text/javascript" src="lib/html5shiv.min.js"></script>
        <script type="text/javascript" src="lib/respond.min.js"></script>
    <![endif]-->
    <style>
        .sdiv
        {
            width: 70px;
            height: 20px;
            line-height: 20px;
            border-radius: 10px;
            background: #ddd;
            text-align: center;
            font-size: 10px;
            cursor: pointer;
            margin: 5px;
        }
        .sdiv-active
        {
            background: red;
            color: #fff;
        }
    </style>
</head>
<body>
    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">悟空送餐</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
             <li class=""><a href="index.htm">首页</a></li>
            <li  class="active"><a href="bus_order_list.htm">订单管理</a></li>
             <li  class="dropdown ">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">商户管理 <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="bus_area_list.htm">地区区域</a></li>  
                <li><a href="bus_market_list.htm">商户</a></li> 
              </ul>
            </li>
            <li class=""><a href="bus_pickup_list.htm">自提点管理</a></li> 
            <li><a href="bus_user_list.htm">配送员管理</a></li>
             <li  class="dropdown ">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">设置 <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="bus_discount_list.htm">优惠活动</a></li> 
                <li><a href="bus_deadline_list.htm">截单</a></li>
                <li><a href="sys_user_list.htm">系统管理员</a></li>  
                <li><a href="bus_feedback_list.htm">意见反馈</a></li>    
              </ul>
            </li>
          </ul>
         
          <ul class="nav navbar-nav navbar-right">
            <li><a id="userInfo" ></a></li>
            <li><a id="loginState" >登录</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
    <!-- Begin page content -->
    <div class="container content">
        <ol class="breadcrumb">
            <li><a href="#">订单管理</a></li>
            <li><a href="bus_order_list.htm">订单</a></li>
            <li class="active">列表</li>
        </ol>
        <div class="container-fluid" style='padding: 0;'>
            <table>
                <tr>
                    <td>
                    </td>
                    <td>
                        订单号：
                    </td>
                    <td colspan="3">
                        <input id="order_code" type="text" style='width: 200px;' />
                    </td>
                    <td>
                        用户ID：
                    </td>
                    <td colspan="2">
                        <input id="user_id" type="text" style='width: 120px;' />
                    </td>
                    <td>
                        <a class="btn btn-primary btn-xs" id="btnSearch" role="button" style="margin-left: 10px;">
                            搜索</a>
                    </td>
                </tr>
                <tr style='margin-top: 10px;'>
                    <td style='text-align: right; width: 100px;'>
                        订单期：
                    </td>
                    <td>
                        <div class='sdiv sdiv-active eat_type' ref='0'>
                            全部
                        </div>
                    </td>
                    <td>
                        <div class='sdiv eat_type' ref='1'>
                            明日午餐
                        </div>
                    </td>
                    <td>
                        <div class='sdiv eat_type' ref='2'>
                            明日晚餐
                        </div>
                    </td>
                    <td>
                        <div class='sdiv eat_type' ref='3'>
                            后天午餐
                        </div>
                    </td>
                    <td>
                        <div class='sdiv eat_type' ref='4'>
                            后天晚餐
                        </div>
                    </td>
                    <td>
                        <!--<div class='sdiv'>
                            3/5午餐
                        </div>-->
                    </td>
                    <td>
                        <!--<div class='sdiv'>
                            历史订单期
                        </div>-->
                    </td>
                    <td>
                    </td>
                </tr>
                <tr style='margin-top: 5px;'>
                    <td style='text-align: right; width: 100px;'>
                        订单状态：
                    </td>
                    <td>
                        <div class='sdiv sdiv-active order_status' ref='0'>
                            全部
                            <!--/*订单状态 1已预订 2待取餐 3待送达 4已完成 5已退单 6申请退单*/-->
                        </div>
                    </td>
                    <td>
                        <div class='sdiv order_status' ref='1'>
                            接单中
                        </div>
                    </td>
                    <td>
                        <div class='sdiv order_status' ref='2'>
                            待提货
                        </div>
                    </td>
                    <td>
                        <div class='sdiv order_status' ref='3'>
                            配送中
                        </div>
                    </td>
                    <td>
                        <div class='sdiv order_status' ref='4'>
                            已完成
                        </div>
                    </td>
                    <td>
                        <div class='sdiv order_status' ref='5'>
                            已取消
                        </div>
                    </td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr style='margin-top: 5px;'>
                    <td style='text-align: right; width: 100px;'>
                        支付方式：
                    </td>
                    <td>
                        <div class='sdiv sdiv-active pay_status ' ref='0'>
                            全部
                        </div>
                    </td>
                    <td>
                        <div class='sdiv pay_status' ref='1'>
                            线上支付
                        </div>
                    </td>
                    <td>
                        <div class='sdiv pay_status' ref='2'>
                            货到付款
                        </div>
                    </td>
                    <td>
                    </td>
                    <td>
                    </td>
                    <td>
                    </td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr style='margin-top: 5px;'>
                    <td style='text-align: right; width: 100px;'>
                        是否有赠品：
                    </td>
                    <td>
                        <div class='sdiv sdiv-active isDiscount' ref='0'>
                            全部
                        </div>
                    </td>
                    <td>
                        <div class='sdiv  isDiscount' ref='1'>
                            有
                        </div>
                    </td>
                    <td>
                        <div class='sdiv isDiscount' ref='2'>
                            无
                        </div>
                    </td>
                    <td>
                    </td>
                    <td>
                    </td>
                    <td>
                    </td>
                    <td>
                    </td>
                    <td>
                    </td>
                </tr>
            </table>
        </div>
        <div class="container-fluid" style='padding: 0;margin-top:10px;margin-bottom:10px;'>
            <div class='row'>
               
                <div class='col-sm-8'>
                    <a id="btnExcelAll" download="data_all.xls" class="btn btn-primary btn-xs">全部导出</a> <a id="btnExcelMarket" download="data_market_order.xls"
                        class="btn btn-primary btn-xs">按商户导出</a> <a download="data_address_order.xls" id="btnExcelPickupAddress" class="btn btn-primary btn-xs">
                            按自提点导出</a> <a download="data_user_order.xls" id="btnExcelDiliveryUser" class="btn btn-primary btn-xs">按配送员导出</a>
                </div>
                 <div class='col-sm-4'>
                </div>
            </div>
        </div>
        <table class="table table-bordered  table-hover  mt10" id='datatable'>
            <thead>
                <tr>
                    <td >
                        识别码
                    </td>
                    <td>
                        订单号
                    </td>
                    <td>
                        订单期
                    </td>
                    <td>
                        订单状态
                    </td>
                    <td>
                        订单时间
                    </td>
                    <td>
                        订单金额
                    </td>
                    <td>
                        支付订单号
                    </td>
                    <td>
                        用户
                    </td>
                    <td>
                        电话
                    </td>
                    <td>
                        自提点
                    </td>
                    <td>
                        配送员
                    </td>
                    <td>
                        赠品
                    </td>
                    <td>
                        操作
                    </td>
                </tr>
            </thead>
            <tbody id="DataList">
            </tbody>
        </table>
        <div id="Pagination" class="pagination">
        </div>
    </div>
    <div style="display: none;">
        <table id='tbExcelAll'>
            <thead>
                <tr>
                    <td>
                        识别码
                    </td>
                    <td>
                        订单号
                    </td>
                    <td>
                        订单期
                    </td>
                    <td>
                        订单状态
                    </td>
                    <td>
                        订单时间
                    </td>
                    <td>
                        订单金额
                    </td>
                    <td>
                        支付订单号
                    </td>
                    <td>
                        用户
                    </td>
                    <td>
                        电话
                    </td>
                    <td>
                        自提点
                    </td>
                    <td>
                        配送员
                    </td>
                    <td>
                        赠品
                    </td>
                    <td>
                        菜品
                    </td>
                </tr>
            </thead>
            <tbody id="dataExcelAll">
            </tbody>
        </table>
        <table id='tbExcelMarket'>
            <thead>
                <tr>
                    <td>
                        商户
                    </td>
                    <td>
                    </td>
                </tr>
            </thead>
            <tbody id="dataExcelMarket">
            </tbody>
        </table>
        <table id='dtExcelUser'>
            <thead>
                <tr>
                    <td>
                        配送员
                    </td>
                    <td>
                    </td>
                </tr>
            </thead>
            <tbody id="dataExcelUser">
            </tbody>
        </table>
         <table id='dtExcelAddress'>
            <thead>
                <tr>
                    <td>
                        自提点
                    </td>
                    <td>
                    </td>
                </tr>
            </thead>
            <tbody id="dataExcelAddress">
            </tbody>
        </table>
    </div>
    <footer class="footer">
      <div class="container">
        <p class="text-muted"></p>
      </div>
    </footer>
    <script src="lib/jqurey/1.12.4/jquery.min.js" type="text/javascript"></script>
    <script src="lib/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="lib/jquery-tmpl/jquery.tmpl.min.js" type="text/javascript"></script>
    <script src="lib/jquery-pagination/lib/jquery.pagination.js" type="text/javascript"></script>
    <script src="lib/layer-v3.0.3/layer/layer.js" type="text/javascript"></script>
    <script src="js/common.js" type="text/javascript"></script>
    <script src="js/bus_order_list.js" type="text/javascript"></script>
    <script src="lib/excellentexport-master/excellentexport.min.js" type="text/javascript"></script>
    <script id="DataTemplate" type="text/x-jquery-tmpl">
        <tr>
	        <td>${order_code.substr(order_code.length-4,4)}</td>  
            <td>${order_code}</td> 
            <td>${create_date}</td> 
            <td>{{if order_status == 1}}已预订{{else order_status == 2}}待取餐{{else order_status == 3}}待送达{{else order_status == 4}}已完成{{else order_status == 5}}已退单{{else order_status == 6}}申请退单{{/if}}</td> 
            <td>${create_date}</td> 
            <td>${total_real_price }</td> 
            <td></td> 
            <td>${user_id}</td> 
            <td>${consignee_phone}</td> 
            <td>${pickup_address_id}</td> 
            <td>${consignee_name}</td> 
            <td>{{if dicountId > 0 }}有{{else}}无{{/if}}</td>  
            <td><a class="btn btn-primary btn-xs" href="#" role="button" onclick="goPageDetail('${id}')" >详情</a>
            <a class="btn btn-primary btn-xs" href="#" role="button" onclick="cancelOrder('${id}')" >取消订单</a>
            </td> 
        </tr>
    </script>
    <script id="dataExcelAllTemplate" type="text/x-jquery-tmpl">
       
        <tr>
	        <td>${order_code.substr(order_code.length-4,4)}</td>  
            <td>${order_code}</td> 
            <td>${create_date}</td> 
            <td>{{if order_status == 1}}已预订{{else order_status == 2}}待取餐{{else order_status == 3}}待送达{{else order_status == 4}}已完成{{else order_status == 5}}已退单{{else order_status == 6}}申请退单{{/if}}</td> 
            <td>${create_date}</td> 
            <td>${total_real_price }</td> 
            <td></td> 
            <td>${user_id}</td> 
            <td>${consignee_phone}</td> 
            <td>${pickup_address_id}</td> 
            <td>${consignee_name}</td> 
            
            <td>{{if orderDiscount.discount_id > 0 }}有{{else}}无{{/if}}</td> 
            <td>
                <table>

                {{each(i,orderDish) listOrderDish}}
                    <tr>
                    <td>${i+1}</td>
                    <td>${orderDish.market_name_cn}</td>
                    <td>${orderDish.market_name_en}</td>
                    <td>${orderDish.dish_name_cn}</td>
                    <td>${orderDish.dish_name_en}</td>
                    <td>${orderDish.count}</td>
                    <td>${orderDish.size_list}</td>
                    <td>${orderDish.unit_discount_price}</td>
                    <td>${orderDish.unit_original_price}</td>
                    <td>${orderDish.total_discount_price}</td>
                    <td>${orderDish.total_original_price}</td>
                    </tr>
                {{/each}}
                </table>
            </td>
        </tr>
    </script>
    <script id="dataExcelMarketTemplate" type="text/x-jquery-tmpl"> 
        <tr>
             <td>${name_cn}</td> 
            <td> 
                <table>
                <tr>
                    <td>
                        识别码
                    </td>
                    <td>
                        订单号
                    </td>
                    <td>
                        订单期
                    </td>
                    <td>
                        订单状态
                    </td>
                    <td>
                        订单时间
                    </td>
                    <td>
                        订单金额
                    </td>
                    <td>
                        支付订单号
                    </td>
                    <td>
                        用户
                    </td>
                    <td>
                        电话
                    </td>
                    <td>
                        自提点
                    </td>
                    <td>
                        配送员
                    </td>
                    <td>
                        赠品
                    </td>
                    <td>
                        菜品
                    </td>
                </tr>
                {{each(i,order) listOrder}}
                <tr>
	                <td>${order_code.substr(order_code.length-4,4)}</td>  
                    <td>${order_code}</td> 
                    <td>${create_date}</td> 
                    <td>{{if order_status == 1}}已预订{{else order_status == 2}}待取餐{{else order_status == 3}}待送达{{else order_status == 4}}已完成{{else order_status == 5}}已退单{{else order_status == 6}}申请退单{{/if}}</td> 
                    <td>${create_date}</td> 
                    <td>${total_real_price }</td> 
                    <td></td> 
                    <td>${user_id}</td> 
                    <td>${consignee_phone}</td> 
                    <td>${pickup_address_id}</td> 
                    <td>${consignee_name}</td>  
                    <td>{{if orderDiscount.discount_id > 0 }}有{{else}}无{{/if}}</td> 
                    <td>
                        <table> 
                        {{each(i,orderDish) listOrderDish}}
                            <tr>
                            <td>${i+1}</td>
                            <td>${orderDish.market_name_cn}</td>
                            <td>${orderDish.market_name_en}</td>
                            <td>${orderDish.dish_name_cn}</td>
                            <td>${orderDish.dish_name_en}</td>
                            <td>${orderDish.count}</td>
                            <td>${orderDish.size_list}</td>
                            <td>${orderDish.unit_discount_price}</td>
                            <td>${orderDish.unit_original_price}</td>
                            <td>${orderDish.total_discount_price}</td>
                            <td>${orderDish.total_original_price}</td>
                            </tr>
                        {{/each}}
                        </table>
                    </td>
                </tr>
                 {{/each}}
                  </table>
            </td>
        </tr>
    </script>

    <script id="dataExcelAddressTemplate" type="text/x-jquery-tmpl"> 
        <tr>
             <td>${name}</td> 
            <td> 
                <table>
                <tr>
                    <td>
                        识别码
                    </td>
                    <td>
                        订单号
                    </td>
                    <td>
                        订单期
                    </td>
                    <td>
                        订单状态
                    </td>
                    <td>
                        订单时间
                    </td>
                    <td>
                        订单金额
                    </td>
                    <td>
                        支付订单号
                    </td>
                    <td>
                        用户
                    </td>
                    <td>
                        电话
                    </td>
                    <td>
                        自提点
                    </td>
                    <td>
                        配送员
                    </td>
                    <td>
                        赠品
                    </td>
                    <td>
                        菜品
                    </td>
                </tr>
                {{each(i,order) listOrder}}
                <tr>
	                <td>${order_code.substr(order_code.length-4,4)}</td>  
                    <td>${order_code}</td> 
                    <td>${create_date}</td> 
                    <td>{{if order_status == 1}}已预订{{else order_status == 2}}待取餐{{else order_status == 3}}待送达{{else order_status == 4}}已完成{{else order_status == 5}}已退单{{else order_status == 6}}申请退单{{/if}}</td> 
                    <td>${create_date}</td> 
                    <td>${total_real_price }</td> 
                    <td></td> 
                    <td>${user_id}</td> 
                    <td>${consignee_phone}</td> 
                    <td>${pickup_address_id}</td> 
                    <td>${consignee_name}</td>  
                    <td>{{if orderDiscount.discount_id > 0 }}有{{else}}无{{/if}}</td> 
                    <td>
                        <table> 
                        {{each(i,orderDish) listOrderDish}}
                            <tr>
                            <td>${i+1}</td>
                            <td>${orderDish.market_name_cn}</td>
                            <td>${orderDish.market_name_en}</td>
                            <td>${orderDish.dish_name_cn}</td>
                            <td>${orderDish.dish_name_en}</td>
                            <td>${orderDish.count}</td>
                            <td>${orderDish.size_list}</td>
                            <td>${orderDish.unit_discount_price}</td>
                            <td>${orderDish.unit_original_price}</td>
                            <td>${orderDish.total_discount_price}</td>
                            <td>${orderDish.total_original_price}</td>
                            </tr>
                        {{/each}}
                        </table>
                    </td>
                </tr>
                 {{/each}}
                  </table>
            </td>
        </tr>
    </script>

     <script id="dataExcelUserTemplate" type="text/x-jquery-tmpl"> 
        <tr>
             <td>${nickname}</td> 
            <td> 
                <table>
                <tr>
                    <td>
                        识别码
                    </td>
                    <td>
                        订单号
                    </td>
                    <td>
                        订单期
                    </td>
                    <td>
                        订单状态
                    </td>
                    <td>
                        订单时间
                    </td>
                    <td>
                        订单金额
                    </td>
                    <td>
                        支付订单号
                    </td>
                    <td>
                        用户
                    </td>
                    <td>
                        电话
                    </td>
                    <td>
                        自提点
                    </td>
                    <td>
                        配送员
                    </td>
                    <td>
                        赠品
                    </td>
                    <td>
                        菜品
                    </td>
                </tr>
                {{each(i,order) listOrder}}
                <tr>
	                <td>${order_code.substr(order_code.length-4,4)}</td>  
                    <td>${order_code}</td> 
                    <td>${create_date}</td> 
                    <td>{{if order_status == 1}}已预订{{else order_status == 2}}待取餐{{else order_status == 3}}待送达{{else order_status == 4}}已完成{{else order_status == 5}}已退单{{else order_status == 6}}申请退单{{/if}}</td> 
                    <td>${create_date}</td> 
                    <td>${total_real_price }</td> 
                    <td></td> 
                    <td>${user_id}</td> 
                    <td>${consignee_phone}</td> 
                    <td>${pickup_address_id}</td> 
                    <td>${consignee_name}</td>  
                    <td>{{if orderDiscount.discount_id > 0 }}有{{else}}无{{/if}}</td> 
                    <td>
                        <table> 
                        {{each(i,orderDish) listOrderDish}}
                            <tr>
                            <td>${i+1}</td>
                            <td>${orderDish.market_name_cn}</td>
                            <td>${orderDish.market_name_en}</td>
                            <td>${orderDish.dish_name_cn}</td>
                            <td>${orderDish.dish_name_en}</td>
                            <td>${orderDish.count}</td>
                            <td>${orderDish.size_list}</td>
                            <td>${orderDish.unit_discount_price}</td>
                            <td>${orderDish.unit_original_price}</td>
                            <td>${orderDish.total_discount_price}</td>
                            <td>${orderDish.total_original_price}</td>
                            </tr>
                        {{/each}}
                        </table>
                    </td>
                </tr>
                 {{/each}}
                  </table>
            </td>
        </tr>
    </script>
</body>
</html>
